<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Creative Invoice Generator</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js" integrity="sha512-GsLlZN/3F2ErC5ifS5QtgpiJtWd43JWSuIgh7mbzZ8zBps+dvLusV+eNQATqgA/HdeKFVgA5v3S/cIrLF7QnIg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>
<body>

    <div class="app-container">
        <!-- Input Controls Section -->
        <div class="controls-container">
            <h2>Invoice Details</h2>
            <div class="control-group">
                <h3>Bill To:</h3>
                <input type="text" id="client-name" placeholder="Client Name / Department">
                <input type="text" id="client-company" placeholder="Company Name">
                <input type="email" id="client-email" placeholder="Email Address">
                
                <div class="default-buttons">
                    <button id="save-defaults-btn" class="util-button">Save as Default</button>
                    <button id="clear-defaults-btn" class="util-button-secondary">Clear Default</button>
                </div>
            </div>

            <!-- NEW: Section for specifying the Google Sheet -->
            <div class="control-group">
                <h3>Google Sheet Source:</h3>
                <input type="text" id="spreadsheet-id" placeholder="Paste Google Sheet ID or URL here">
                <button id="load-sheets-btn">Load Sheet Tabs</button>
            </div>
            
            <div class="control-group">
                <h3>Select Timesheet Tab:</h3>
                <select id="sheet-selector">
                    <option value="">Enter Sheet ID and click Load</option>
                </select>
            </div>
            
            <div class="control-group">
                <h3>Billing Period:</h3>
                <div class="date-range">
                    <label for="start-date">From:</label>
                    <input type="date" id="start-date">
                    <label for="end-date">To:</label>
                    <input type="date" id="end-date">
                </div>
                <button id="fetch-data-btn">Get Timesheet Data</button>
            </div>
            <div class="control-group">
                <h3>Billing Method</h3>
                <select id="billing-method">
                    <option value="hourly">Per Hour</option>
                    <option value="fixed">Fixed Rate</option>
                </select>
                <div class="billing-method-inputs">
                    <div id="hourly-rate-group">
                        <label for="hourly-rate">Hourly Rate ($)</label>
                        <input type="number" id="hourly-rate" value="5.00" step="0.01" min="0">
                    </div>
                    <div id="fixed-rate-group" class="hidden">
                        <label for="fixed-rate">Total Project Amount ($)</label>
                        <input type="number" id="fixed-rate" value="500.00" step="0.01" min="0">
                    </div>
                </div>
            </div>
            <div class="control-group">
                <h3>Payment Info:</h3>
                <input type="text" id="payment-method" placeholder="Payment Method (e.g., Payoneer, PayPal)">
                <textarea id="payment-details" placeholder="Your Payment Details (e.g., PayPal email, Bank Account Info)"></textarea>
            </div>
            <button id="generate-pdf-btn" class="cta-button">Generate & Download PDF</button>
        </div>

        <!-- Live Invoice Preview Section -->
        <div class="invoice-container">
            <div id="invoice-preview">
                <header class="invoice-header">
                    <div class="logo-container">
                        <h1>Erika Mae M. Guido</h1>
                        <p>guidoerikam@gmail.com | 0912-032-7038</p>
                    </div>
                    <div class="invoice-title">
                        <h1>INVOICE</h1>
                        <p><strong>Invoice ID:</strong> <span id="preview-invoice-id"></span></p>
                    </div>
                </header>
                <section class="billing-details">
                    <div class="bill-to">
                        <h4>BILL TO</h4>
                        <p id="preview-client-name">Client Name</p>
                        <p id="preview-client-company">Company Name</p>
                        <p id="preview-client-email">Email Address</p>
                    </div>
                    <div class="invoice-meta">
                        <p><strong>Invoice Date:</strong> <span id="preview-invoice-date"></span></p>
                        <p><strong>Billing Period:</strong> <span id="preview-billing-period"></span></p>
                    </div>
                </section>
<table class="items-table">
                    <thead>
                        <tr>
                            <th class="date-col">Date</th>
                            <th class="task-col">Tasks</th>
                            <!-- ADDED IDs TO THESE TWO COLUMNS -->
                            <th id="from-th" class="time-col">From</th>
                            <th id="to-th" class="time-col">To</th>
                            <th class="time-col">Duration</th>
                        </tr>
                    </thead>
                    <tbody id="invoice-body">
                        <tr><td colspan="5" style="text-align: center;">Please fill out the form to generate the invoice.</td></tr>
                    </tbody>
                </table>
                <footer class="invoice-footer">
                    <div class="payment-info">
                        <h4>Payment Details</h4>
                        <p><strong>Method:</strong> <span id="preview-payment-method"></span></p>
                        <pre id="preview-payment-details"></pre>
                    </div>
                    <div class="total-section">
                        <p>Total Hours</p>
                        <h2 id="total-hours">00:00</h2>
                        
                        <div id="subtotal-container" class="hidden">
                            <p class="total-amount-label">Subtotal</p>
                            <h2 id="preview-subtotal" class="total-amount-value">$0.00</h2>
                        </div>
                        <div id="fee-container" class="hidden">
                            <p class="total-amount-label">Payoneer Fee (2%)</p>
                            <h2 id="preview-fee" class="total-amount-value">$0.00</h2>
                        </div>

                        <p id="total-amount-label" class="total-amount-label">Total Amount</p>
                        <h2 id="total-amount" class="total-amount-value">$0.00</h2>
                    </div>
                </footer>
            </div>
        </div>
    </div>
    <script src="script.js"></script>
</body>
</html>

